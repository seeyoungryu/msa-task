# π“ MSA κµ¬μ„±, Redis μΊμ‹±, Docker κΈ°λ° CI/CD ν”„λ΅μ νΈ κµ¬ν„ λ νμ§€ν† λ¦¬

![Untitled](https://github.com/user-attachments/assets/8d008528-893a-40d8-aa29-843487d92d7d)

## μ‹¤ν–‰ μμ„μ™€ ν™•μΈ λ°©λ²•

μ „μ²΄ μ„λΉ„μ¤ νλ¦„μ μ‹¤ν–‰ μμ„μ™€ ν™•μΈ λ°©λ²•μ…λ‹λ‹¤.

<details>
<summary>1. Eureka Server μ‹¤ν–‰</summary>
1. `server` μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•©λ‹λ‹¤.
2. λΈλΌμ°μ €μ—μ„ `http://localhost:19090`λ΅ μ ‘μ†ν•μ—¬ Eureka μ„λ²„ λ€μ‹λ³΄λ“λ¥Ό ν™•μΈν•©λ‹λ‹¤.
</details>

<details>
<summary>2. Gateway μ„λΉ„μ¤ μ‹¤ν–‰</summary>
1. `gateway` μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•©λ‹λ‹¤.
2. Eureka λ€μ‹λ³΄λ“μ—μ„ `gateway` μ„λΉ„μ¤κ°€ λ“±λ΅λμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
</details>

<details>
<summary>3. Auth μ„λΉ„μ¤ μ‹¤ν–‰</summary>
1. `auth` μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•©λ‹λ‹¤.
2. Eureka λ€μ‹λ³΄λ“μ—μ„ `auth` μ„λΉ„μ¤κ°€ λ“±λ΅λμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
</details>

<details>
<summary>4. Product μ„λΉ„μ¤ μ‹¤ν–‰ (λ‘ μΈμ¤ν„΄μ¤)</summary>
1. `product` μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ λ‘ λ² μ‹¤ν–‰ν•©λ‹λ‹¤. κ° μΈμ¤ν„΄μ¤μ ν¬νΈλ” `19093`κ³Ό `19094`λ΅ μ„¤μ •ν•©λ‹λ‹¤.
2. Eureka λ€μ‹λ³΄λ“μ—μ„ λ‘ κ°μ `product` μ„λΉ„μ¤ μΈμ¤ν„΄μ¤κ°€ λ“±λ΅λμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
</details>

<details>
<summary>5. Order μ„λΉ„μ¤ μ‹¤ν–‰</summary>
1. `order` μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•©λ‹λ‹¤.
2. Eureka λ€μ‹λ³΄λ“μ—μ„ `order` μ„λΉ„μ¤κ°€ λ“±λ΅λμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
</details>



--- 

## κΈ°λ¥ ν…μ¤νΈ

<details>
<summary>1. λ΅κ·ΈμΈ API ν…μ¤νΈ</summary>
1. λΈλΌμ°μ €λ‚ API ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ `http://localhost:19091/auth/signIn?user_id=test`μ— GET μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤.
2. JWT ν† ν°μ΄ λ°ν™λλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
</details>

<details>
<summary>2. μƒν’ λ©λ΅ μ΅°ν API ν…μ¤νΈ (λ΅λ“λ°Έλ°μ‹± ν™•μΈ)</summary>
1. λΈλΌμ°μ €λ‚ API ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ `http://localhost:19091/products`μ— GET μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤.
2. μ‘λ‹µ ν—¤λ”μ— `Server-Port` κ°’μ΄ `19093`κ³Ό `19094`λ΅ λ²κ°μ•„ κ°€λ©° μ„¤μ •λλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
</details>

<details>
<summary>3. μ£Όλ¬Έμ— μƒν’ μ¶”κ°€ API ν…μ¤νΈ</summary>
1. λΈλΌμ°μ €λ‚ API ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ `http://localhost:19091/order`μ— POST μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤.
   - μ”μ²­ λ°”λ”” μμ‹:
     ```json
     {
       "name": "Test Order",
       "product_ids": [1, 2]
     }
     ```
2. μ£Όλ¬Έμ— μƒν’μ΄ μ •μƒμ μΌλ΅ μ¶”κ°€λλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
3. μƒν’μ΄ μ΅΄μ¬ν•μ§€ μ•μ„ κ²½μ° μ£Όλ¬Έμ— μ €μ¥λμ§€ μ•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
</details>

---

### κΈ°λ³Έ API κµ¬μ„±

   <details>
<summary>API λ…μ„Έμ„ ν™•μΈν•κΈ°</summary>

### API λ©λ΅

1. **μƒν’ μ¶”κ°€ API**
   - **URL**: `POST /products`
   - **μƒν’ Entity**
     | Key         | Value                          |
     |-------------|--------------------------------|
     | product_id  | Long (Primary, Auto Increment) |
     | name        | String                         |
     | supply_price| Integer                        |

2. **μƒν’ λ©λ΅ μ΅°ν API**
   - **URL**: `GET /products`
   - **μ‘λ‹µ ν•νƒ**: List<μ‘λ‹µ κ°μ²΄>
   - **μ‘λ‹µ κ°μ²΄**
     | Key         | Value  |
     |-------------|--------|
     | product_id  | Long   |
     | name        | String |
     | supply_price| Integer|

3. **μ£Όλ¬Έ μ¶”κ°€ API**
   - **URL**: `POST /order`
   - **μ£Όλ¬Έ Entity**
     | Key        | Value                          |
     |------------|--------------------------------|
     | order_id   | Long (Primary, Auto Increment) |
     | name       | String                         |
     | product_ids| List<Long>                     |
   - **μ£Όλ¬Έ λ§¤ν•‘ μƒν’ Entity**
     | Key        | Value                          |
     |------------|--------------------------------|
     | id         | Long (Primary, Auto Increment) |
     | product_id | Long                           |

4. **μ£Όλ¬Έμ— μƒν’μ„ μ¶”κ°€ν•λ” API**
   - **URL**: `PUT /order/{orderId}`
   - **μ”μ²­ Body**
     | Key        | Value |
     |------------|-------|
     | product_id | Long  |

5. **μ£Όλ¬Έ λ‹¨κ±΄ μ΅°ν API**
   - **URL**: `GET /order/{orderId}`
   - **μ‘λ‹µ κ°μ²΄**
     | Key        | Value          |
     |------------|----------------|
     | order_id   | Long           |
     | product_ids| List<Integer>  |

6. **λ΅κ·ΈμΈ API**
   - **URL**: `GET /auth/signIn?user_id={string}`
</details>



@Todo :  (Gateway μ„λΉ„μ¤μ Filter λ§ ν†µκ³Όν•  μ μλ„λ΅ κµ¬μ„± / μ¶”κ°€κµ¬ν„ κ°€λ¥μ‹ DB μ—°κ²° μμ •)

## κµ¬ν„ μƒμ„Έ λ‚΄μ©

<details>
<summary>μƒν’ μ„λΉ„μ¤λ” λΌμ΄λ“λ΅λΉ ν•μ‹μΌλ΅ λ΅λ“λ°Έλ°μ‹± κµ¬μ„±</summary>
1. λΌμ΄λ“λ΅λΉ ν•μ‹μΌλ΅ λ΅λ“λ°Έλ°μ‹±μ„ κµ¬ν„ν•΄μ„ μƒν’ μ„λΉ„μ¤κ°€ νΈμ¶λ  λ•λ§λ‹¤ λ‘ μ„λΉ„μ¤λ¥Ό λ°λ³µν•λ©° νΈμ¶λκ² κµ¬μ„±ν•©λ‹λ‹¤.
2. μƒν’ λ©λ΅μ„ μ΅°νν•  λ•λ§λ‹¤ API μ μ‘λ‹µ ν—¤λ”μ `Server-Port` κ°’μ΄ `19093` , `19094` λ΅ λ³€κ²½λ©λ‹λ‹¤.
</details>

<details>
<summary>λ¶„μ‚°μ¶”μ  κµ¬ν„</summary>
- `μ£Όλ¬Έ μ„λΉ„μ¤` μ™€ `μƒν’ μ„λΉ„μ¤` μ— Zipkin μ„ μ—°λ™ν•κ³ , νΈμ¶μ‹ Zipkin λ€μ‹λ³΄λ“μ— `Duration` μ΄ μΈ΅μ •λ©λ‹λ‹¤. (λ€μ‹λ³΄λ“λ΅ ν™•μΈ κ°€λ¥ -> @Todo : λ€μ‹λ³΄λ“ μ΄λ―Έμ§€ μ¶”κ°€ μμ •)
</details>

<details>
<summary>μΊμ‹± κΈ°λ¥ κµ¬ν„</summary>
- μ£Όλ¬Έ μ΅°ν API μ κ²°κ³Όλ¥Ό μΊμ‹± μ²λ¦¬ν•μ—¬ **60μ΄ λ™μ•**μ€ DB μ—μ„ λ¶λ¬μ¤λ” λ°μ΄ν„°κ°€ μ•„λ‹ **λ©”λ¨λ¦¬μ— μΊμ‹±λ λ°μ΄ν„°**κ°€ λ³΄μ—¬μ§€λ„λ΅ μ„¤μ •ν•©λ‹λ‹¤.
</details>

<details>
<summary>μ™Έλ¶€ μ”μ²­ λ³΄νΈ</summary>
- Oauth2,JWT κΈ°λ°μΌλ΅ μΈμ¦/μΈκ°€λ¥Ό κµ¬μ„±ν•μ—¬ μΈκ°€ μ—†μ΄ `μƒν’ μ„λΉ„μ¤`, `μ£Όλ¬Έ μ„λΉ„μ¤`λ¥Ό νΈμ¶ν•  λ• **401** HTTP **Status Codeλ¥Ό μ‘λ‹µν•λ„λ΅ μ„¤μ •ν•©λ‹λ‹¤**
</details>

<details>
<summary>Advanced - μΊμ‹ ν™μ©</summary>
@ Todo : λ‚΄μ©μ •λ¦¬ ν•„μ”ν•¨ 
1. [μƒν’ μ¶”κ°€ API](https://www.notion.so/0c299a44a1db4301bd26ad2f5004564b?pvs=21)  λ¥Ό νΈμ¶ ν•  κ²½μ° [μƒν’ μ΅°ν API](https://www.notion.so/0c299a44a1db4301bd26ad2f5004564b?pvs=21) μ μ‘λ‹µ λ°μ΄ν„° μΊμ‹κ°€ κ°±μ‹ λλ„λ΅ κµ¬ν„ν•  μμ •μ…λ‹λ‹¤. 
    (~~MSA~~ **μΈλ©”λ¨λ¦¬ μ €μ¥μ† λ° μΊμ‹± κ°•μ** μ¤‘ **Spring Boot ν”„λ΅μ νΈμ— μΊμ‹± μ μ©ν•κΈ°** λ¥Ό μ°Έκ³ ν•΄μ„ κµ¬ν„μμ •μ…λ‹λ‹¤)
2. μƒν’ μ¶”κ°€ ν›„ [μƒν’ μ΅°ν API](https://www.notion.so/0c299a44a1db4301bd26ad2f5004564b?pvs=21) νΈμ¶ μ‹ λ°μ΄ν„°κ°€ λ³€κ²½ λλ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.
</details>

<details>
<summary>λ΅μ»¬κ³Ό μ„λ²„μ ν™κ²½μ„ λ¶„λ¦¬</summary>
- λ΅μ»¬μ—μ„λ” [localhost:3306](http://localhost:3306) μΌλ΅ DBμ— μ ‘κ·Όν•κ³ , μ„λ²„μ— λ°°ν¬μ‹μ—” RDS μ£Όμ†λ΅ μ ‘κ·Όν•κ² κµ¬μ„±ν•λ„λ΅ ν™κ²½μ„ λ¶„λ¦¬ν•©λ‹λ‹¤ (ν™κ²½μ€ `dev`, `prod` ν”„λ΅ν•„λ΅ λ‚λ‰©λ‹λ‹¤).
</details>



---

### signin μ²λ¦¬ κ΄€λ ¨ 

GET /auth/signIn?user_id={string} APIκ°€ DB μ—°κ²° μ—†μ΄ Gateway μ„λΉ„μ¤μ Filterλ¥Ό ν†µκ³Όν•λ„λ΅ κµ¬μ„±ν•λ” κ²ƒμ΄ λ©μ μ΄λΌλ©΄, Auth μ„λΉ„μ¤μ—μ„ κ°„λ‹¨ν JWT ν† ν°μ„ μƒμ„±ν•μ—¬ λ°ν™ν•κ³ , Gatewayμ—μ„ μ΄ ν† ν°μ„ κ²€μ¦ν•λ” λ°©μ‹μΌλ΅ μ¶©λ¶„ν•©λ‹λ‹¤. μ΄ κ²½μ° μ‚¬μ©μ μ—”ν‹°ν‹°λ‚ DBλ” ν•„μ”ν•μ§€ μ•μµλ‹λ‹¤.


---

# μ§„ν–‰ μ¤‘ 
